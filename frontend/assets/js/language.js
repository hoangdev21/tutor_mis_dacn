// Language translations
const translations = {
  vi: {
    // Page title
    pageTitle: 'TutorMis - Nền tảng gia sư hàng đầu',

    // Navigation
    navHome: 'Trang Chủ',
    navPartners: 'Đối Tác',
    navHowItWorks: 'Cách Hoạt Động',
    navFeaturedTutors: 'Gia Sư Tiêu Biểu',
    navTestimonials: 'Nhận Xét',
    navContact: 'Liên Hệ',

    // Hero Section
    heroTitle:
      "Tìm Kiếm <span class='highlight'>Gia Sư Tinh Hoa</span> - <span class='highlight'>Bứt Phá Điểm Số</span> Ngay Hôm Nay",
    heroDescription:
      'Kết nối với 1,000+ gia sư đã xác thực. Học tập cá nhân hóa, tiến bộ nhanh chóng chỉ từ 200k/buổi.',
    searchPlaceholder: 'Tìm tên môn học, gia sư...',
    searchButton: 'Tìm kiếm',
    needTutor: 'Tôi cần gia sư',
    imTutor: 'Tôi là gia sư',

    // Trust badges
    verifiedTutors: '1,000+ Gia sư đã xác thực',
    moneyBack: 'Hoàn tiền nếu không hài lòng',
    support247: 'Hỗ trợ 24/7',

    // Trust badges section
    trustedBy: 'Được tin dùng bởi 10,000+ học viên',
    verifiedTutors2: 'Gia sư 100% xác thực',
    isoSecurity: 'Bảo mật dữ liệu ISO 27001',
    ministryCoop: 'Hợp tác với Bộ GD&ĐT',

    // University Partners
    partnersTitle: 'Chúng tôi hợp tác với 80+ trường đại học và giáo dục hàng đầu',
    partnersSubtitle: 'Đồng hành cùng các trường đại học và tổ chức giáo dục uy tín trên toàn quốc',
    partnersCta: 'Và nhiều trường đại học khác trên toàn quốc...',
    joinCommunity: 'Tham gia cộng đồng',

    // How it works
    howItWorksBadge: 'Quy trình',
    howItWorksTitle: 'Cách hoạt động',
    howItWorksSubtitle: '3 bước đơn giản để bắt đầu hành trình học tập hiệu quả',
    step1Title: 'Đăng ký miễn phí - Xác minh nhanh chóng',
    step1Desc:
      'Tạo tài khoản chỉ trong 30 giây. Hoàn thiện hồ sơ và xác minh email để đảm bảo bảo mật tuyệt đối.',
    step1Feature1: '✓ Miễn phí 100%',
    step1Feature2: '✓ Bảo mật cao',
    step2Title: 'Tìm gia sư phù hợp - Lọc thông minh',
    step2Desc:
      'Sử dụng bộ lọc để tìm gia sư gần nhất. Xem profile chi tiết, đánh giá thực và liên hệ trực tiếp.',
    step2Feature1: '✓ Lọc thông minh',
    step2Feature2: '✓ Đánh giá thực',
    step3Title: 'Bắt đầu học - Thanh toán an toàn',
    step3Desc:
      'Thống nhất lịch học linh hoạt, thanh toán bảo mật và bắt đầu hành trình học tập hiệu quả ngay.',
    step3Feature1: '✓ Lịch linh hoạt',
    step3Feature2: '✓ Thanh toán an toàn',
    startNow: 'Bắt đầu ngay',
    learnMore: 'Tìm hiểu thêm',

    // Certificates
    certificatesTitle: 'Các Chứng Chỉ Nổi Bật Khi Tham Gia TutorMis',
    certificatesSubtitle:
      'Được công nhận và khen thưởng cho những đóng góp và thành tích xuất sắc của bạn',
    cert1Title: 'Gia Sư Xuất Sắc',
    cert1Desc:
      'Chứng chỉ dành cho gia sư có điểm đánh giá cao và đóng góp tích cực cho cộng đồng học tập',
    cert1Count: '200+ gia sư nhận được',
    cert2Title: 'Học Viên Tiến Bộ',
    cert2Desc: 'Chứng nhận cho học viên đạt được tiến bộ vượt trội trong quá trình học tập',
    cert2Count: '500+ học viên đạt được',
    cert3Title: 'Người Chiến Thắng Cuộc Thi',
    cert3Desc:
      'Chứng chỉ dành cho người thắng cuộc trong các cuộc thi kiến thức do TutorMis tổ chức',
    cert3Count: '50+ người chiến thắng',
    cert4Title: 'Tham Gia Tích Cực',
    cert4Desc:
      'Chứng nhận cho những thành viên tích cực tham gia các hoạt động cộng đồng và sự kiện',
    cert4Count: '1000+ thành viên nhận được',
    cert5Title: 'Chuyên Gia Môn Học',
    cert5Desc:
      'Chứng chỉ xác nhận chuyên môn sâu về một môn học cụ thể sau khi hoàn thành các khóa đào tạo',
    cert5Count: '150+ chuyên gia',
    cert6Title: 'Đóng Góp Cộng Đồng',
    cert6Desc: 'Chứng nhận cho những đóng góp ý nghĩa cho cộng đồng TutorMis và giáo dục',
    cert6Count: '300+ đóng góp viên',

    // Featured Tutors
    tutorsTitle: 'Gia Sư Tiêu Biểu - Chất Lượng Đảm Bảo Từ TutorMis',
    tutorsSubtitle: 'Những gia sư xuất sắc nhất đang đồng hành cùng học viên',

    // Testimonials
    testimonialsTitle: 'Học Viên Nói Gì Về TutorMis',
    testimonialsSubtitle: 'Những trải nghiệm thực tế từ học viên và phụ huynh',

    // Contact
    contactTitle: 'Liên hệ với chúng tôi',
    contactSubtitle: 'Gửi thông tin của bạn, chúng tôi sẽ phản hồi trong thời gian sớm nhất',
    contactName: 'Họ và tên',
    contactEmail: 'Email',
    contactPhone: 'Số điện thoại',
    contactMessage: 'Nội dung',
    contactNamePlaceholder: 'Nhập họ và tên của bạn',
    contactEmailPlaceholder: 'email@example.com',
    contactPhonePlaceholder: '0123456789',
    contactMessagePlaceholder: 'Nhập nội dung cần liên hệ...',
    sendInfo: 'Gửi thông tin',

    // Auth Modals
    loginTitle: 'Đăng nhập',
    registerTitle: 'Đăng ký tài khoản',
    email: 'Email',
    password: 'Mật khẩu',
    confirmPassword: 'Xác nhận mật khẩu',
    fullName: 'Họ và tên',
    phone: 'Số điện thoại',
    loginEmailPlaceholder: 'Nhập email của bạn',
    loginPasswordPlaceholder: 'Nhập mật khẩu của bạn',
    rememberLogin: 'Ghi nhớ đăng nhập',
    forgotPassword: 'Quên mật khẩu?',
    loginButton: 'Đăng nhập',
    or: 'Hoặc',
    noAccount: 'Chưa có tài khoản?',
    registerNow: 'Đăng ký ngay',
    youAre: 'Bạn là:',
    studentParent: 'Học sinh/Phụ huynh',
    tutor: 'Gia sư',
    fullNamePlaceholder: 'Nhập họ và tên',
    emailPlaceholder: 'email@example.com',
    phonePlaceholder: '0123456789',
    passwordPlaceholder: 'Nhập mật khẩu của bạn',
    confirmPasswordPlaceholder: 'Nhập lại mật khẩu của bạn',
    agreeTerms: 'Tôi đồng ý với',
    termsOfUse: 'Điều khoản sử dụng',
    privacyPolicy: 'Chính sách bảo mật',
    registerButton: 'Đăng ký',
    haveAccount: 'Đã có tài khoản?',
    loginNow: 'Đăng nhập ngay',

    // Terms Modal
    termsTitle: 'ĐIỀU KHOẢN VÀ ĐIỀU KIỆN SỬ DỤNG DỊCH VỤ TUTORMIS',
    close: 'Đóng',

    // Policy Modal
    policyTitle: 'Chính sách bảo mật',

    // Thành công Modal
    successTitle: 'Thành công!',
    successClose: 'Đóng',

    // Intro Overlay
    welcomeTitle: 'Chào mừng đến với TutorMis',
    welcomeSubtitle: 'Nền tảng gia sư hàng đầu Việt Nam',
    welcomeDesc: 'Kết nối tri thức và tương lai',

    // Footer
    footerTitle: 'TutorMis',
    footerDesc: 'Nền tảng gia sư trực tuyến hàng đầu Việt Nam, kết nối tri thức và tương lai.',
    quickLinks: 'Liên kết nhanh',
    support: 'Hỗ trợ',
    helpCenter: 'Trung tâm trợ giúp',
    contact: 'Liên hệ',
    copyright: '&copy; 2024 TutorMis. Nền tảng kết nối tri thức và tương lai.',
  },
  en: {
    // Page title
    pageTitle: 'TutorMis - Leading Tutor Platform',

    // Navigation
    navHome: 'Home',
    navPartners: 'Partners',
    navHowItWorks: 'How It Works',
    navFeaturedTutors: 'Featured Tutors',
    navTestimonials: 'Reviews',
    navContact: 'Contact',

    // Hero Section
    heroTitle:
      "Find <span class='highlight'>Elite Tutors</span> - <span class='highlight'>Break Records</span> Today",
    heroDescription:
      'Connect with 1,000+ verified tutors. Personalized learning, rapid progress from just 200k/session.',
    searchPlaceholder: 'Search subject name, tutor...',
    searchButton: 'Search',
    needTutor: 'I need a tutor',
    imTutor: "I'm a tutor",

    // Trust badges
    verifiedTutors: '1,000+ Verified Tutors',
    moneyBack: 'Money back guarantee',
    support247: '24/7 Support',

    // Trust badges section
    trustedBy: 'Trusted by 10,000+ students',
    verifiedTutors2: '100% Verified Tutors',
    isoSecurity: 'ISO 27001 Data Security',
    ministryCoop: 'Cooperation with Ministry of Education',

    // University Partners
    partnersTitle: 'We partner with 80+ leading universities and educational institutions',
    partnersSubtitle:
      'Accompanying universities and reputable educational organizations nationwide',
    partnersCta: 'And many more universities nationwide...',
    joinCommunity: 'Join the community',

    // How it works
    howItWorksBadge: 'Process',
    howItWorksTitle: 'How it works',
    howItWorksSubtitle: '3 simple steps to start your effective learning journey',
    step1Title: 'Free registration - Quick verification',
    step1Desc:
      'Create account in just 30 seconds. Complete profile and verify email for absolute security.',
    step1Feature1: '✓ 100% Free',
    step1Feature2: '✓ High Security',
    step2Title: 'Find suitable tutor - Smart filtering',
    step2Desc:
      'Use filters to find nearest tutors. View detailed profiles, real reviews and contact directly.',
    step2Feature1: '✓ Smart Filtering',
    step2Feature2: '✓ Real Reviews',
    step3Title: 'Start learning - Secure payment',
    step3Desc:
      'Agree on flexible schedule, secure payment and start your effective learning journey now.',
    step3Feature1: '✓ Flexible Schedule',
    step3Feature2: '✓ Secure Payment',
    startNow: 'Start now',
    learnMore: 'Learn more',

    // Certificates
    certificatesTitle: 'Outstanding Certificates When Joining TutorMis',
    certificatesSubtitle:
      'Recognized and rewarded for your outstanding contributions and achievements',
    cert1Title: 'Excellent Tutor',
    cert1Desc:
      'Certificate for tutors with high ratings and positive contributions to the learning community',
    cert1Count: '200+ tutors received',
    cert2Title: 'Progressive Student',
    cert2Desc:
      'Certificate for students who achieve outstanding progress in their learning process',
    cert2Count: '500+ students achieved',
    cert3Title: 'Competition Winner',
    cert3Desc: 'Certificate for winners in knowledge competitions organized by TutorMis',
    cert3Count: '50+ winners',
    cert4Title: 'Active Participant',
    cert4Desc:
      'Certificate for members who actively participate in community activities and events',
    cert4Count: '1000+ members received',
    cert5Title: 'Subject Expert',
    cert5Desc:
      'Certificate confirming deep expertise in a specific subject after completing training courses',
    cert5Count: '150+ experts',
    cert6Title: 'Community Contributor',
    cert6Desc: 'Certificate for meaningful contributions to the TutorMis community and education',
    cert6Count: '300+ contributors',

    // Featured Tutors
    tutorsTitle: 'Featured Tutors - Quality Guaranteed by TutorMis',
    tutorsSubtitle: 'The best tutors accompanying students',

    // Testimonials
    testimonialsTitle: 'What Students Say About TutorMis',
    testimonialsSubtitle: 'Real experiences from students and parents',

    // Contact
    contactTitle: 'Contact us',
    contactSubtitle: 'Send us your information, we will respond as soon as possible',
    contactName: 'Full name',
    contactEmail: 'Email',
    contactPhone: 'Phone number',
    contactMessage: 'Content',
    contactNamePlaceholder: 'Enter your full name',
    contactEmailPlaceholder: 'email@example.com',
    contactPhonePlaceholder: '0123456789',
    contactMessagePlaceholder: 'Enter content to contact...',
    sendInfo: 'Send information',

    // Auth Modals
    loginTitle: 'Login',
    registerTitle: 'Register account',
    email: 'Email',
    password: 'Password',
    confirmPassword: 'Confirm password',
    fullName: 'Full name',
    phone: 'Phone number',
    loginEmailPlaceholder: 'Enter your email',
    loginPasswordPlaceholder: 'Enter your password',
    rememberLogin: 'Remember login',
    forgotPassword: 'Forgot password?',
    loginButton: 'Login',
    or: 'Or',
    noAccount: "Don't have an account?",
    registerNow: 'Register now',
    youAre: 'You are:',
    studentParent: 'Student/Parent',
    tutor: 'Tutor',
    fullNamePlaceholder: 'Enter full name',
    emailPlaceholder: 'email@example.com',
    phonePlaceholder: '0123456789',
    passwordPlaceholder: 'Enter your password',
    confirmPasswordPlaceholder: 'Re-enter your password',
    agreeTerms: 'I agree with',
    termsOfUse: 'Terms of use',
    privacyPolicy: 'Privacy policy',
    registerButton: 'Register',
    haveAccount: 'Already have an account?',
    loginNow: 'Login now',

    // Terms Modal
    termsTitle: 'TUTORMIS SERVICE TERMS AND CONDITIONS',
    close: 'Close',

    // Policy Modal
    policyTitle: 'Privacy Policy',

    // Thành công Modal
    successTitle: 'Success!',
    successClose: 'Close',

    // Intro Overlay
    welcomeTitle: 'Welcome to TutorMis',
    welcomeSubtitle: "Vietnam's leading tutor platform",
    welcomeDesc: 'Connecting knowledge and future',

    // Footer
    footerTitle: 'TutorMis',
    footerDesc: "Vietnam's leading online tutoring platform, connecting knowledge and future.",
    quickLinks: 'Quick links',
    support: 'Support',
    helpCenter: 'Help center',
    contact: 'Contact',
    copyright: '&copy; 2024 TutorMis. Platform connecting knowledge and future.',
  },
};

// Current language
let currentLang = 'vi';

// Bật/Tắt language dropdown
function toggleLanguageDropdown() {
  const dropdown = document.querySelector('.language-dropdown');
  dropdown.classList.toggle('open');
}

// Đóng dropdown when clicking outside
document.addEventListener('click', function (event) {
  const dropdown = document.querySelector('.language-dropdown');
  const languageOptions = document.getElementById('languageOptions');

  if (!dropdown.contains(event.target)) {
    dropdown.classList.remove('open');
  }
});

// Switch language function
function switchLanguage(lang) {
  if (lang === currentLang) return;

  console.log('Switching language to:', lang);
  currentLang = lang;

  // Đóng dropdown
  const dropdown = document.querySelector('.language-dropdown');
  if (dropdown) {
    dropdown.classList.remove('open');
  }

  // Cập nhật language button
  updateLanguageButton(lang);

  // Cập nhật page title
  document.title = translations[lang].pageTitle;

  // Cập nhật navigation
  const navHome = document.querySelector('.nav__link[href="#home"]');
  if (navHome)
    navHome.innerHTML = '<i class="fas fa-home"></i>&nbsp; ' + translations[lang].navHome;

  const navPartners = document.querySelector('.nav__link[href="#university-partners"]');
  if (navPartners)
    navPartners.innerHTML =
      '<i class="fas fa-handshake"></i>&nbsp; ' + translations[lang].navPartners;

  const navHowItWorks = document.querySelector('.nav__link[href="#how-it-works"]');
  if (navHowItWorks)
    navHowItWorks.innerHTML =
      '<i class="fas fa-cogs"></i>&nbsp; ' + translations[lang].navHowItWorks;

  const navFeaturedTutors = document.querySelector('.nav__link[href="#featured-tutors"]');
  if (navFeaturedTutors)
    navFeaturedTutors.innerHTML =
      '<i class="fas fa-star"></i>&nbsp; ' + translations[lang].navFeaturedTutors;

  const navTestimonials = document.querySelector('.nav__link[href="#testimonials"]');
  if (navTestimonials)
    navTestimonials.innerHTML =
      '<i class="fas fa-comments"></i>&nbsp; ' + translations[lang].navTestimonials;

  const navContact = document.querySelector('.nav__link[href="#contact"]');
  if (navContact)
    navContact.innerHTML = '<i class="fas fa-envelope"></i>&nbsp; ' + translations[lang].navContact;

  // Cập nhật hero section
  const heroTitle = document.querySelector('.hero__title');
  if (heroTitle) heroTitle.innerHTML = translations[lang].heroTitle;

  const heroDesc = document.querySelector('.hero__description');
  if (heroDesc) heroDesc.textContent = translations[lang].heroDescription;

  const searchInput = document.querySelector('#searchInput');
  if (searchInput) searchInput.placeholder = translations[lang].searchPlaceholder;

  const searchBtn = document.querySelector('.search__button');
  if (searchBtn)
    searchBtn.innerHTML = '<i class="fas fa-search"></i> ' + translations[lang].searchButton;

  const heroPrimaryBtn = document.querySelector('.hero__buttons .btn--primary');
  if (heroPrimaryBtn)
    heroPrimaryBtn.innerHTML =
      '<dotlottie-wc src="https://lottie.host/40f4b784-6ff4-4b20-b065-4e6ca08c7973/Phf0VFiJ0U.lottie" style="width:40px;height:40px;display:inline-block;vertical-align:middle;margin-right:0;" autoplay loop></dotlottie-wc><span>' +
      translations[lang].needTutor +
      '</span><span class="right-arrow"><img src="assets/images/icon/rotate.png" alt="right-arrow" style="width:20px;height:20px;"></span>';

  const heroOutlineBtn = document.querySelector('.hero__buttons .btn--outline');
  if (heroOutlineBtn)
    heroOutlineBtn.innerHTML =
      '<img src="assets/images/icon/tutor-1.png" alt="' +
      translations[lang].imTutor +
      '" style="width: 40px; height: 40px; display: inline-block; vertical-align: middle; margin-right: 8px;">' +
      translations[lang].imTutor;

  // Cập nhật trust badges in hero
  const heroBadges = document.querySelectorAll('.hero__trust-badges .trust-badge span');
  if (heroBadges.length >= 3) {
    heroBadges[0].textContent = translations[lang].verifiedTutors;
    heroBadges[1].textContent = translations[lang].moneyBack;
    heroBadges[2].textContent = translations[lang].support247;
  }

  // Cập nhật trust badges section
  const trustBadges = document.querySelectorAll('.trust-badges__grid .trust-badge-item span');
  if (trustBadges.length >= 4) {
    trustBadges[0].textContent = translations[lang].trustedBy;
    trustBadges[1].textContent = translations[lang].verifiedTutors2;
    trustBadges[2].textContent = translations[lang].isoSecurity;
    trustBadges[3].textContent = translations[lang].ministryCoop;
  }

  // Cập nhật university partners
  const partnersTitle = document.querySelector('.university-partners .section__title');
  if (partnersTitle) partnersTitle.textContent = translations[lang].partnersTitle;

  const partnersSubtitle = document.querySelector('.university-partners .section__subtitle');
  if (partnersSubtitle) partnersSubtitle.textContent = translations[lang].partnersSubtitle;

  const partnersText = document.querySelector('.partners__text');
  if (partnersText) partnersText.textContent = translations[lang].partnersCta;

  const partnersCtaBtn = document.querySelector('.partners__cta .btn');
  if (partnersCtaBtn) partnersCtaBtn.textContent = translations[lang].joinCommunity;

  // Cập nhật how it works
  const howItWorksBadge = document.querySelector('.how-it-works .section__badge');
  if (howItWorksBadge) howItWorksBadge.textContent = translations[lang].howItWorksBadge;

  const howItWorksTitle = document.querySelector('.how-it-works .section__title');
  if (howItWorksTitle) howItWorksTitle.textContent = translations[lang].howItWorksTitle;

  const howItWorksSubtitle = document.querySelector('.how-it-works .section__subtitle');
  if (howItWorksSubtitle) howItWorksSubtitle.textContent = translations[lang].howItWorksSubtitle;

  // Cập nhật steps
  const steps = document.querySelectorAll('.step');
  if (steps.length >= 3) {
    if (steps[0]) {
      const step0Title = steps[0].querySelector('.step__title');
      if (step0Title) step0Title.textContent = translations[lang].step1Title;

      const step0Desc = steps[0].querySelector('.step__description');
      if (step0Desc) step0Desc.textContent = translations[lang].step1Desc;

      const step0Features = steps[0].querySelectorAll('.step__feature');
      if (step0Features.length >= 2) {
        step0Features[0].textContent = translations[lang].step1Feature1;
        step0Features[1].textContent = translations[lang].step1Feature2;
      }
    }

    if (steps[1]) {
      const step1Title = steps[1].querySelector('.step__title');
      if (step1Title) step1Title.textContent = translations[lang].step2Title;

      const step1Desc = steps[1].querySelector('.step__description');
      if (step1Desc) step1Desc.textContent = translations[lang].step2Desc;

      const step1Features = steps[1].querySelectorAll('.step__feature');
      if (step1Features.length >= 2) {
        step1Features[0].textContent = translations[lang].step2Feature1;
        step1Features[1].textContent = translations[lang].step2Feature2;
      }
    }

    if (steps[2]) {
      const step2Title = steps[2].querySelector('.step__title');
      if (step2Title) step2Title.textContent = translations[lang].step3Title;

      const step2Desc = steps[2].querySelector('.step__description');
      if (step2Desc) step2Desc.textContent = translations[lang].step3Desc;

      const step2Features = steps[2].querySelectorAll('.step__feature');
      if (step2Features.length >= 2) {
        step2Features[0].textContent = translations[lang].step3Feature1;
        step2Features[1].textContent = translations[lang].step3Feature2;
      }
    }
  }

  const howItWorksCtaBtn = document.querySelector('.how-it-works__cta .btn-primary');
  if (howItWorksCtaBtn) howItWorksCtaBtn.textContent = translations[lang].startNow;

  const howItWorksCtaLink = document.querySelector('.how-it-works__cta a');
  if (howItWorksCtaLink) howItWorksCtaLink.textContent = translations[lang].learnMore;

  // Cập nhật certificates
  const certificatesTitle = document.querySelector('.certificates .section__title');
  if (certificatesTitle) certificatesTitle.textContent = translations[lang].certificatesTitle;

  const certificatesSubtitle = document.querySelector('.certificates .section__subtitle');
  if (certificatesSubtitle)
    certificatesSubtitle.textContent = translations[lang].certificatesSubtitle;

  const certificates = document.querySelectorAll('.certificate__card');
  if (certificates.length >= 6) {
    for (let i = 0; i < 6; i++) {
      if (certificates[i]) {
        const certTitle = certificates[i].querySelector('.certificate__title');
        if (certTitle) certTitle.textContent = translations[lang][`cert${i + 1}Title`];

        const certDesc = certificates[i].querySelector('.certificate__description');
        if (certDesc) certDesc.textContent = translations[lang][`cert${i + 1}Desc`];

        const certCount = certificates[i].querySelector('.certificate__count');
        if (certCount) certCount.textContent = translations[lang][`cert${i + 1}Count`];
      }
    }
  }

  // Cập nhật featured tutors
  const tutorsTitle = document.querySelector('.featured-tutors .section__title');
  if (tutorsTitle) tutorsTitle.textContent = translations[lang].tutorsTitle;

  const tutorsSubtitle = document.querySelector('.featured-tutors .section__subtitle');
  if (tutorsSubtitle) tutorsSubtitle.textContent = translations[lang].tutorsSubtitle;

  // Cập nhật testimonials
  const testimonialsTitle = document.querySelector('.testimonials .section__title');
  if (testimonialsTitle) testimonialsTitle.textContent = translations[lang].testimonialsTitle;

  const testimonialsSubtitle = document.querySelector('.testimonials .section__subtitle');
  if (testimonialsSubtitle)
    testimonialsSubtitle.textContent = translations[lang].testimonialsSubtitle;

  // Cập nhật contact
  const contactTitle = document.querySelector('.contact-home .section__title');
  if (contactTitle) contactTitle.textContent = translations[lang].contactTitle;

  const contactSubtitle = document.querySelector('.contact-home .section__subtitle');
  if (contactSubtitle) contactSubtitle.textContent = translations[lang].contactSubtitle;

  const contactNameLabel = document.querySelector('label[for="contactName"]');
  if (contactNameLabel)
    contactNameLabel.innerHTML = '<i class="fas fa-user"></i> ' + translations[lang].contactName;

  const contactNameInput = document.querySelector('#contactName');
  if (contactNameInput) contactNameInput.placeholder = translations[lang].contactNamePlaceholder;

  const contactEmailLabel = document.querySelector('label[for="contactEmail"]');
  if (contactEmailLabel)
    contactEmailLabel.innerHTML =
      '<i class="fas fa-envelope"></i> ' + translations[lang].contactEmail;

  const contactEmailInput = document.querySelector('#contactEmail');
  if (contactEmailInput) contactEmailInput.placeholder = translations[lang].contactEmailPlaceholder;

  const contactPhoneLabel = document.querySelector('label[for="contactPhone"]');
  if (contactPhoneLabel)
    contactPhoneLabel.innerHTML = '<i class="fas fa-phone"></i> ' + translations[lang].contactPhone;

  const contactPhoneInput = document.querySelector('#contactPhone');
  if (contactPhoneInput) contactPhoneInput.placeholder = translations[lang].contactPhonePlaceholder;

  const contactMessageLabel = document.querySelector('label[for="contactMessage"]');
  if (contactMessageLabel)
    contactMessageLabel.innerHTML =
      '<i class="fas fa-comment-dots"></i> ' + translations[lang].contactMessage;

  const contactMessageInput = document.querySelector('#contactMessage');
  if (contactMessageInput)
    contactMessageInput.placeholder = translations[lang].contactMessagePlaceholder;

  const contactBtn = document.querySelector('.contact__form .btn');
  if (contactBtn)
    contactBtn.innerHTML = '<i class="fas fa-paper-plane"></i> ' + translations[lang].sendInfo;

  // Cập nhật auth modals
  const loginModalTitle = document.querySelector('#loginModal .modal__title');
  if (loginModalTitle) loginModalTitle.textContent = translations[lang].loginTitle;

  const registerModalTitle = document.querySelector('#registerModal .modal__title');
  if (registerModalTitle) registerModalTitle.textContent = translations[lang].registerTitle;

  // Login form
  const loginEmailLabel = document.querySelector('#loginForm label[for="email"]');
  if (loginEmailLabel) loginEmailLabel.textContent = translations[lang].email;

  const loginEmailInput = document.querySelector('#loginForm input[name="email"]');
  if (loginEmailInput) loginEmailInput.placeholder = translations[lang].loginEmailPlaceholder;

  const loginPasswordLabel = document.querySelector('#loginForm label[for="password"]');
  if (loginPasswordLabel) loginPasswordLabel.textContent = translations[lang].password;

  const loginPasswordInput = document.querySelector('#loginForm input[name="password"]');
  if (loginPasswordInput)
    loginPasswordInput.placeholder = translations[lang].loginPasswordPlaceholder;

  const loginCheckbox = document.querySelector('#loginForm .checkbox span');
  if (loginCheckbox && loginCheckbox.nextSibling)
    loginCheckbox.nextSibling.textContent = translations[lang].rememberLogin;

  const loginFormLink = document.querySelector('#loginForm .form__link');
  if (loginFormLink) loginFormLink.textContent = translations[lang].forgotPassword;

  const loginBtn = document.querySelector('#loginForm .btn--primary span');
  if (loginBtn) loginBtn.textContent = translations[lang].loginButton;

  const loginDivider = document.querySelector('#loginForm .form__divider span');
  if (loginDivider) loginDivider.textContent = translations[lang].or;

  const loginSwitch = document.querySelector('#loginForm .form__switch');
  if (loginSwitch)
    loginSwitch.innerHTML =
      translations[lang].noAccount +
      ' <a href="#" onclick="switchModal(\'loginModal\', \'registerModal\')">' +
      translations[lang].registerNow +
      '</a>';

  // Register form
  const registerRoleLabel = document.querySelector('#registerForm label[for="role"]');
  if (registerRoleLabel) registerRoleLabel.textContent = translations[lang].youAre;

  const registerRoleCards = document.querySelectorAll('#registerForm .role__card span');
  if (registerRoleCards.length >= 2) {
    registerRoleCards[0].textContent = translations[lang].studentParent;
    registerRoleCards[1].textContent = translations[lang].tutor;
  }

  const registerFullNameLabel = document.querySelector('#registerForm label[for="fullName"]');
  if (registerFullNameLabel) registerFullNameLabel.textContent = translations[lang].fullName;

  const registerFullNameInput = document.querySelector('#registerForm input[name="fullName"]');
  if (registerFullNameInput)
    registerFullNameInput.placeholder = translations[lang].fullNamePlaceholder;

  const registerEmailLabel = document.querySelector('#registerForm label[for="email"]');
  if (registerEmailLabel) registerEmailLabel.textContent = translations[lang].email;

  const registerEmailInput = document.querySelector('#registerForm input[name="email"]');
  if (registerEmailInput) registerEmailInput.placeholder = translations[lang].emailPlaceholder;

  const registerPhoneLabel = document.querySelector('#registerForm label[for="phone"]');
  if (registerPhoneLabel) registerPhoneLabel.textContent = translations[lang].phone;

  const registerPhoneInput = document.querySelector('#registerForm input[name="phone"]');
  if (registerPhoneInput) registerPhoneInput.placeholder = translations[lang].phonePlaceholder;

  const registerPasswordLabel = document.querySelector('#registerForm label[for="password"]');
  if (registerPasswordLabel) registerPasswordLabel.textContent = translations[lang].password;

  const registerPasswordInput = document.querySelector('#registerForm input[name="password"]');
  if (registerPasswordInput)
    registerPasswordInput.placeholder = translations[lang].passwordPlaceholder;

  const registerConfirmPasswordLabel = document.querySelector(
    '#registerForm label[for="confirmPassword"]'
  );
  if (registerConfirmPasswordLabel)
    registerConfirmPasswordLabel.textContent = translations[lang].confirmPassword;

  const registerConfirmPasswordInput = document.querySelector(
    '#registerForm input[name="confirmPassword"]'
  );
  if (registerConfirmPasswordInput)
    registerConfirmPasswordInput.placeholder = translations[lang].confirmPasswordPlaceholder;

  const registerCheckbox = document.querySelector('#registerForm .checkbox span');
  if (registerCheckbox && registerCheckbox.nextSibling)
    registerCheckbox.nextSibling.innerHTML =
      translations[lang].agreeTerms +
      ' <a href="#" id="show-terms" class="form__link">' +
      translations[lang].termsOfUse +
      '</a> ' +
      'and' +
      ' <a href="#" id="show-policy" class="form__link">' +
      translations[lang].privacyPolicy +
      '</a>';

  const registerBtn = document.querySelector('#registerForm .btn--primary span');
  if (registerBtn) registerBtn.textContent = translations[lang].registerButton;

  const registerSwitch = document.querySelector('#registerForm .form__switch');
  if (registerSwitch)
    registerSwitch.innerHTML =
      translations[lang].haveAccount +
      ' <a href="#" onclick="switchModal(\'registerModal\', \'loginModal\')">' +
      translations[lang].loginNow +
      '</a>';

  // Terms modal
  const termsModalTitle = document.querySelector('#termsModal .modal__title');
  if (termsModalTitle) termsModalTitle.textContent = translations[lang].termsTitle;

  const termsModalBtn = document.querySelector('#termsModal .btn');
  if (termsModalBtn) termsModalBtn.textContent = translations[lang].close;

  // Policy modal
  const policyModalTitle = document.querySelector('#policyModal .modal__title');
  if (policyModalTitle) policyModalTitle.textContent = translations[lang].policyTitle;

  const policyModalBtn = document.querySelector('#policyModal .btn');
  if (policyModalBtn) policyModalBtn.textContent = translations[lang].close;

  // Thành công modal
  const successModalTitle = document.querySelector('#successModal .success__title');
  if (successModalTitle) successModalTitle.textContent = translations[lang].successTitle;

  const successModalBtn = document.querySelector('#successModal .btn');
  if (successModalBtn) successModalBtn.textContent = translations[lang].successClose;

  // Intro overlay
  const introTitle = document.querySelector('.intro-title');
  if (introTitle) introTitle.textContent = translations[lang].welcomeTitle;

  const introSubtitle = document.querySelector('.intro-subtitle');
  if (introSubtitle) introSubtitle.textContent = translations[lang].welcomeSubtitle;

  const introDesc = document.querySelector('.intro-description');
  if (introDesc) introDesc.textContent = translations[lang].welcomeDesc;

  // Footer
  const footerTitle = document.querySelector('.footer__title');
  if (footerTitle) footerTitle.textContent = translations[lang].footerTitle;

  const footerDesc = document.querySelector('.footer__description');
  if (footerDesc) footerDesc.textContent = translations[lang].footerDesc;

  const footerHeadings = document.querySelectorAll('.footer__heading');
  if (footerHeadings.length >= 3) {
    footerHeadings[0].textContent = translations[lang].quickLinks;
    footerHeadings[1].textContent = translations[lang].support;
    footerHeadings[2].textContent = translations[lang].contact;
  }

  const footerHelpLink = document.querySelector('.footer__links a[href="#"]');
  if (footerHelpLink) footerHelpLink.textContent = translations[lang].helpCenter;

  const footerBottom = document.querySelector('.footer__bottom p');
  if (footerBottom) footerBottom.innerHTML = translations[lang].copyright;

  // Cập nhật language button
  updateLanguageButton(lang);

  // Store language preference
  try {
    localStorage.setItem('tutornis-lang', lang);
    console.log('Language saved to localStorage:', lang);
  } catch (e) {
    console.error('Failed to save language to localStorage:', e);
  }
}

// Khởi tạo language on page load
document.addEventListener('DOMContentLoaded', function () {
  try {
    const savedLang = localStorage.getItem('tutornis-lang') || 'vi';
    console.log('Language loaded from localStorage:', savedLang);

    // Ensure DOM is fully loaded before switching language
    setTimeout(() => {
      switchLanguage(savedLang);
    }, 100);
  } catch (e) {
    console.error('Failed to load language from localStorage:', e);
    setTimeout(() => {
      switchLanguage('vi'); // fallback to Vietnamese
    }, 100);
  }
});

// Cập nhật language button display
function updateLanguageButton(lang) {
  const languageBtn = document.querySelector('.language-btn');
  if (!languageBtn) {
    console.warn('Language button not found');
    return;
  }

  const flagIcon = languageBtn.querySelector('.flag-icon');
  if (!flagIcon) {
    console.warn('Flag icon not found');
    return;
  }

  // Find the text node and update it
  let textNode = null;
  for (let node of languageBtn.childNodes) {
    if (node.nodeType === Node.TEXT_NODE && node.textContent.trim()) {
      textNode = node;
      break;
    }
  }

  if (lang === 'vi') {
    flagIcon.src = 'https://flagcdn.com/w20/vn.png';
    flagIcon.alt = 'Vietnam Flag';
    if (textNode) textNode.textContent = ' VIE ';
  } else {
    flagIcon.src = 'https://flagcdn.com/w20/us.png';
    flagIcon.alt = 'US Flag';
    if (textNode) textNode.textContent = ' EN ';
  }

  // Cập nhật active state in dropdown options
  document.querySelectorAll('.language-option').forEach((option) => {
    option.classList.remove('active');
    if (option.dataset.lang === lang) {
      option.classList.add('active');
    }
  });
}
