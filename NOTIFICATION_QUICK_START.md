# HÆ°á»›ng Dáº«n Sá»­ Dá»¥ng Há»‡ Thá»‘ng ThÃ´ng BÃ¡o

## DÃ nh Cho NgÆ°á»i DÃ¹ng

### Xem ThÃ´ng BÃ¡o

1. **Kiá»ƒm tra sá»‘ lÆ°á»£ng thÃ´ng bÃ¡o má»›i:**
   - NhÃ¬n vÃ o icon chuÃ´ng ğŸ”” á»Ÿ gÃ³c pháº£i trÃªn cÃ¹ng
   - Sá»‘ mÃ u Ä‘á» hiá»‡n sá»‘ lÆ°á»£ng thÃ´ng bÃ¡o chÆ°a Ä‘á»c

2. **Má»Ÿ danh sÃ¡ch thÃ´ng bÃ¡o:**
   - Click vÃ o icon chuÃ´ng
   - Panel thÃ´ng bÃ¡o sáº½ má»Ÿ ra bÃªn dÆ°á»›i

3. **Äá»c thÃ´ng bÃ¡o:**
   - Click vÃ o báº¥t ká»³ thÃ´ng bÃ¡o nÃ o
   - ThÃ´ng bÃ¡o sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  Ä‘Ã£ Ä‘á»c
   - Báº¡n sáº½ Ä‘Æ°á»£c chuyá»ƒn Ä‘áº¿n trang liÃªn quan (náº¿u cÃ³)

4. **ÄÃ¡nh dáº¥u táº¥t cáº£ Ä‘Ã£ Ä‘á»c:**
   - Click nÃºt "ÄÃ¡nh dáº¥u táº¥t cáº£ Ä‘Ã£ Ä‘á»c" á»Ÿ header cá»§a panel
   - Táº¥t cáº£ thÃ´ng bÃ¡o sáº½ Ä‘Æ°á»£c Ä‘Ã¡nh dáº¥u lÃ  Ä‘Ã£ Ä‘á»c

5. **XÃ³a thÃ´ng bÃ¡o:**
   - Hover chuá»™t lÃªn thÃ´ng bÃ¡o
   - Click vÃ o icon "X" mÃ u xÃ¡m á»Ÿ gÃ³c pháº£i
   - ThÃ´ng bÃ¡o sáº½ bá»‹ xÃ³a khá»i danh sÃ¡ch

### CÃ¡c Loáº¡i ThÃ´ng BÃ¡o

#### DÃ nh Cho Há»c Sinh ğŸ‘¨â€ğŸ“

- **âœ… YÃªu cáº§u Ä‘Æ°á»£c cháº¥p nháº­n:** Gia sÆ° Ä‘Ã£ cháº¥p nháº­n yÃªu cáº§u Ä‘áº·t lá»‹ch cá»§a báº¡n
- **âŒ YÃªu cáº§u bá»‹ tá»« chá»‘i:** Gia sÆ° Ä‘Ã£ tá»« chá»‘i yÃªu cáº§u Ä‘áº·t lá»‹ch cá»§a báº¡n
- **ğŸ“ KhÃ³a há»c hoÃ n thÃ nh:** KhÃ³a há»c cá»§a báº¡n Ä‘Ã£ hoÃ n thÃ nh
- **ğŸ“§ Tin nháº¯n má»›i:** Báº¡n cÃ³ tin nháº¯n má»›i tá»« gia sÆ°

#### DÃ nh Cho Gia SÆ° ğŸ‘¨â€ğŸ«

- **ğŸ“… YÃªu cáº§u Ä‘áº·t lá»‹ch má»›i:** Há»c sinh má»›i gá»­i yÃªu cáº§u Ä‘áº·t lá»‹ch
- **âœ… BÃ i viáº¿t Ä‘Æ°á»£c duyá»‡t:** Admin Ä‘Ã£ phÃª duyá»‡t bÃ i viáº¿t blog cá»§a báº¡n
- **âŒ BÃ i viáº¿t bá»‹ tá»« chá»‘i:** Admin Ä‘Ã£ tá»« chá»‘i bÃ i viáº¿t blog cá»§a báº¡n
- **âœ… Há»“ sÆ¡ Ä‘Æ°á»£c duyá»‡t:** Admin Ä‘Ã£ phÃª duyá»‡t há»“ sÆ¡ gia sÆ° cá»§a báº¡n
- **âŒ Há»“ sÆ¡ bá»‹ tá»« chá»‘i:** Admin Ä‘Ã£ tá»« chá»‘i há»“ sÆ¡ gia sÆ° cá»§a báº¡n
- **ğŸ’¬ BÃ¬nh luáº­n má»›i:** CÃ³ ngÆ°á»i bÃ¬nh luáº­n vá» bÃ i viáº¿t cá»§a báº¡n
- **ğŸ“§ Tin nháº¯n má»›i:** Báº¡n cÃ³ tin nháº¯n má»›i tá»« há»c sinh

## DÃ nh Cho Developer

### ThÃªm ThÃ´ng BÃ¡o VÃ o Trang Má»›i

1. **ThÃªm CSS:**
```html
<link rel="stylesheet" href="../../assets/css/notifications.css">
```

2. **ThÃªm JavaScript:**
```html
<script src="../../assets/js/notifications.js"></script>
```

3. **Äáº£m báº£o HTML cÃ³ notification button:**
```html
<button class="notification-btn">
  <i class="fas fa-bell"></i>
  <span class="notification-badge" id="notificationBadge">0</span>
</button>
```

### Táº¡o ThÃ´ng BÃ¡o Má»›i Tá»« Backend

#### VÃ­ Dá»¥ 1: ThÃ´ng bÃ¡o khi cÃ³ booking request má»›i

```javascript
const { notifyBookingRequest } = require('../utils/notifications');

// Trong createBookingRequest controller
try {
  const studentProfile = await StudentProfile.findOne({ user: studentId });
  const studentName = studentProfile?.fullName || student.email;
  
  await notifyBookingRequest(bookingRequest, tutorId, studentName);
} catch (error) {
  console.error('Failed to create notification:', error);
}
```

#### VÃ­ Dá»¥ 2: ThÃ´ng bÃ¡o khi admin approve blog

```javascript
const { notifyBlogApproved } = require('../utils/notifications');

// Trong moderateBlogPost controller
if (action === 'approve') {
  await notifyBlogApproved(blogPost, blogPost.author._id);
}
```

#### VÃ­ Dá»¥ 3: Táº¡o thÃ´ng bÃ¡o custom

```javascript
const { createNotification } = require('../utils/notifications');

await createNotification({
  type: 'system',
  recipientId: userId,
  data: {
    title: 'ThÃ´ng BÃ¡o Há»‡ Thá»‘ng',
    message: 'Há»‡ thá»‘ng sáº½ báº£o trÃ¬ vÃ o 2h sÃ¡ng ngÃ y mai'
  },
  link: '/maintenance-notice'
});
```

### ThÃªm Loáº¡i ThÃ´ng BÃ¡o Má»›i

1. **Cáº­p nháº­t Notification Model:**
```javascript
// backend/src/models/Notification.js
enum: [
  ...,
  'your_new_type'  // ThÃªm type má»›i
]
```

2. **ThÃªm configuration:**
```javascript
// backend/src/utils/notifications.js
const notificationConfig = {
  your_new_type: {
    icon: 'fa-your-icon',
    color: 'blue',
    getTitleAndMessage: (data) => ({
      title: 'Your Title',
      message: 'Your Message'
    })
  }
};
```

3. **Táº¡o helper function:**
```javascript
// backend/src/utils/notifications.js
async function notifyYourNewEvent(params) {
  return createNotification({
    type: 'your_new_type',
    recipientId: params.recipientId,
    data: {
      // Your data here
    },
    link: '/your-link',
    relatedId: params.relatedId,
    relatedModel: 'YourModel'
  });
}

module.exports = {
  ...,
  notifyYourNewEvent
};
```

4. **Cáº­p nháº­t frontend styles:**
```javascript
// frontend/assets/js/notifications.js
const notificationStyles = {
  ...,
  your_new_type: { icon: 'fa-your-icon', color: '#yourcolor' }
};
```

### Testing Notifications

#### Test API Endpoints

```bash
# Get notifications
curl -X GET http://localhost:5000/api/notifications \
  -H "Authorization: Bearer YOUR_TOKEN"

# Mark as read
curl -X PUT http://localhost:5000/api/notifications/NOTIFICATION_ID/read \
  -H "Authorization: Bearer YOUR_TOKEN"

# Delete notification
curl -X DELETE http://localhost:5000/api/notifications/NOTIFICATION_ID \
  -H "Authorization: Bearer YOUR_TOKEN"
```

#### Test Notification Creation

```javascript
// Create test script: backend/tests/test-notifications.js
const { notifyBookingRequest } = require('../src/utils/notifications');

async function testNotification() {
  const mockBooking = {
    _id: 'test123',
    student: 'studentId',
    subject: { name: 'ToÃ¡n', level: 'THPT' }
  };
  
  await notifyBookingRequest(
    mockBooking,
    'tutorId',
    'Nguyá»…n VÄƒn A'
  );
  
  console.log('âœ… Notification created successfully!');
}

testNotification();
```

### Debugging

#### Enable Debug Logs

```javascript
// frontend/assets/js/notifications.js
// Uncomment console.log statements

console.log('ğŸ”” Notification loaded:', notifications);
console.log('ğŸ“Š Unread count:', unreadCount);
```

#### Check Database

```javascript
// MongoDB shell
use tutormis;
db.notifications.find({ recipient: ObjectId("userId") }).pretty();
db.notifications.countDocuments({ recipient: ObjectId("userId"), isRead: false });
```

#### Monitor API Calls

```javascript
// Chrome DevTools > Network tab
// Filter: "notifications"
// Check request/response
```

## FAQ

### Q: Táº¡i sao tÃ´i khÃ´ng nháº­n Ä‘Æ°á»£c thÃ´ng bÃ¡o?

**A:** Kiá»ƒm tra:
1. Token cÃ³ cÃ²n há»£p lá»‡ khÃ´ng?
2. API endpoint cÃ³ hoáº¡t Ä‘á»™ng khÃ´ng?
3. Console cÃ³ bÃ¡o lá»—i khÃ´ng?
4. Database cÃ³ notification record khÃ´ng?

### Q: Badge khÃ´ng cáº­p nháº­t real-time?

**A:** Há»‡ thá»‘ng cáº­p nháº­t má»—i 30 giÃ¢y. Äá»ƒ cáº­p nháº­t ngay láº­p tá»©c:
- Refresh trang
- Click vÃ o icon chuÃ´ng
- Hoáº·c giáº£m interval trong `notifications.js`

### Q: LÃ m sao Ä‘á»ƒ xÃ³a táº¥t cáº£ thÃ´ng bÃ¡o cÅ©?

**A:** Há»‡ thá»‘ng tá»± Ä‘á»™ng xÃ³a thÃ´ng bÃ¡o Ä‘Ã£ Ä‘á»c sau 30 ngÃ y. Hoáº·c call:
```javascript
await Notification.cleanupOldNotifications();
```

### Q: CÃ³ thá»ƒ táº¯t thÃ´ng bÃ¡o khÃ´ng?

**A:** Hiá»‡n táº¡i chÆ°a cÃ³ tÃ­nh nÄƒng nÃ y. CÃ³ thá»ƒ má»Ÿ rá»™ng báº±ng cÃ¡ch thÃªm:
- User preferences table
- Toggle notification settings
- Filter notifications by type

### Q: Performance issue khi cÃ³ nhiá»u notifications?

**A:** 
- Sá»­ dá»¥ng pagination (Ä‘Ã£ implement)
- Add database indexes (Ä‘Ã£ cÃ³)
- Consider caching layer
- Cleanup old notifications thÆ°á»ng xuyÃªn

## Support

Náº¿u gáº·p váº¥n Ä‘á»:
1. Check documentation: `NOTIFICATION_SYSTEM_DOCUMENTATION.md`
2. Check console logs
3. Test API endpoints vá»›i Postman
4. Contact: dev@tutormis.com
